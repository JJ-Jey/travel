<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="//www.thymeleaf.org/extras/spring-security"
	th:replace="~{ layout/layout :: basic(~{::head}, ~{::main}) }">
<head>
	<link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
	
	<link rel="stylesheet" href="/css/question/list.css">
	
	<script type="text/javascript">
		$(function(){
			$('#summernote').summernote();
		});
		
		function clickedBtnUpdate(){
			$(".detail-update").css("display", "flex");
			$(".detail-default").hide();
		}
		
		function clickedBtnCancel(){
			$(".detail-update").hide();
			$(".detail-default").show();
		}
	</script>
</head>
<main>
	<h1>메인영역</h1>
	<div class="wrap view-size">
		<p>QnA 게시판</p>
		
		<a href="/questions/new">문의하기</a>
		
		<h1>메인 영역</h1>
		<div class="warp view-size">
		
		<section id="detail">
			<h1>게시글 내용</h1>
			<div class="wrap">
				<p class="tit">상세 정보</p>
				
				<dl class="flex">
					<dt>글번호</dt>
					<dd th:text="${detail.no}"></dd>
				</dl>
				<dl class="flex">
					<dt>작성일</dt>
					<!-- <dd th:text="${detail.createdDate}"></dd> -->
				</dl>
				<dl class="flex">
					<dt>작성자</dt>
					<dd th:text="${detail.writer}"></dd>
				</dl>
				
				<form th:action="|/questions/${detail.no}|" method="post">
					<dl class="flex">
						<dt>제목</dt>
						<dd>
							<div class="detail-default">
								<span th:text="${detail.title}"></span>
							</div>
							<div class="detail-update">
								<input type="text" name="title" th:value="${detail.title}">
							</div>
						</dd>
					</dl>
					<dl>
						<dt>상세정보</dt>
						<dd>
							<div class="detail-default" th:utext="${detail.content}"></div>
							<div class="detail-update">
								<textarea id="summernote" name="content">[(${detail.content})]</textarea>
							</div>
						</dd>
					</dl>
					
					
					<div class="detail-update flex center">
						<button type="button" onclick="clickedBtnCancel()">취소</button>
						<input type="hidden" name="_method" value="put">
						<button type="submit">수정 완료</button>
					</div>
				</form>
				
				<div class="detail-default flex center">
					<a href="/questions">
						<button type="button">목록</button>
					</a>
					
					<!-- onclick 속성은 ()호출 형식으로 입력하기 -->
					<th:block th:if="${#authentication.name == detail.writer}">
					<!-- <th:block th:if="sessionScope.userId == detail.writer"> -->
						<button type="button" onclick="clickedBtnUpdate()">수정</button>
					</th:block>
					<!-- th:if="${#authorization.expression()}" -->
					<th:block th:if="${#authentication.name == detail.writer}">
						<form th:action="|/questions/${detail.no}|" method="post">
							<input type="hidden" name="_method" value="DELETE">
							<button type="submit">삭제</button>
						</form>
					</th:block>
					
					<!-- 관리자 삭제 버튼 -->
					<th:block sec:authorize="hasRole('ROLE_ADMIN')">
						<form th:action="|/questions/${detail.no}|" method="post">
							<input type="hidden" name="_method" value="patch">
							<button type="submit">삭제</button>
						</form>
					</th:block>
					
				</div>
			</div>
		</section>
		</div>
	</div>
</main>
</html>
